CREATE DATABASE IF NOT EXISTS `toolingVal`;

CREATE TABLE `models` (
  `model_name` VARCHAR(30) NOT NULL,
  `model_qr` VARCHAR(30) NULL,
  `pn_pcb` VARCHAR(11) NOT NULL,
  `wl_no` INT NULL,
  PRIMARY KEY (`model_name`));

CREATE TABLE `suppliers` (
  `supp_name` VARCHAR(30) NOT NULL,
  `supp_info` VARCHAR(45) NULL,
  PRIMARY KEY (`supp_name`));

CREATE TABLE `plates` (
  `pl_id` INT NOT NULL AUTO_INCREMENT,
  `pl_job` VARCHAR(11) NOT NULL,
  `supp_name` VARCHAR(30) NULL,
  `model_name` VARCHAR(30) NOT NULL,
  `pl_no_serie` VARCHAR(3) NULL,
  `pl_ver` VARCHAR(2) NULL,
  `pl_date` DATE NULL,
  `pl_status` VARCHAR(10) NULL,
  `pl_bc` VARCHAR(20) NULL,
  `pl_qr` BLOB NULL,
  `pl_current_us` INT NULL,
  `pl_mx_us` INT NULL,
  PRIMARY KEY (`pl_id`),
  CONSTRAINT `fk_pl_model`
    FOREIGN KEY (`model_name`)
    REFERENCES `toolingVal`.`models` (`model_name`),
  CONSTRAINT `fk_pl_supplier`
    FOREIGN KEY (`supp_name`)
    REFERENCES `toolingVal`.`suppliers` (`supp_name`)
 );

CREATE TABLE `squeegees` (
  `sq_id` INT NOT NULL,
  `sq_length` INT NULL,
  `sq_side` VARCHAR(1) NULL,
  `sq_status` VARCHAR(10) NULL,
  `sq_bc` VARCHAR(20) NULL,
  `sq_qr` BLOB NULL,
  `sq_current_us` INT NULL,
  `sq_mx_us` INT NULL,
  PRIMARY KEY (`sq_id`))

CREATE TABLE `stencils` (
  `st_id` INT NOT NULL AUTO_INCREMENT, 
  `st_job` VARCHAR(11) NOT NULL,
  `supp_name` VARCHAR(30) NOT NULL, 
  `model_name` VARCHAR(30) NOT NULL,
  `st_no_serie` VARCHAR(3) NULL,
  `st_ver` VARCHAR(2) NULL,
  `st_side` VARCHAR(3) NULL,
  `thickness` INT NULL,
  `st_status` VARCHAR(10) NULL,
  `st_bc` VARCHAR(20) NULL,
  `st_qr` BLOB NULL,
  `st_current_us` INT NULL,
  `st_mx_us` INT NULL,
  PRIMARY KEY (`st_id`),
  CONSTRAINT `fk_stencils_models`
    FOREIGN KEY (`model_name`)
    REFERENCES `toolingVal`.`models` (`model_name`),
  CONSTRAINT `fk_stencils_suppliers`
    FOREIGN KEY (`supp_name`)
    REFERENCES `toolingVal`.`suppliers` (`supp_name`)
);

CREATE TABLE `stencil_history` (
  `stencil_id` INT NOT NULL, 
  `st_h_date` DATE NOT NULL,
  `st_h_status` VARCHAR(10) NOT NULL,
  `st_h_com` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`stencil_id`,"st_h_date"),
  CONSTRAINT `fk_history_stencils`
    FOREIGN KEY (`stencil_id`)
    REFERENCES `toolingVal`.`stencils` (`st_id`));

CREATE TABLE `squeegee_history` (
  `squeegee_id` INT NOT NULL, 
  `sq_h_date` DATE NOT NULL,
  `sq_h_status` VARCHAR(10) NOT NULL,
  `sq_h_com` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`squeegee_id`,"sq_h_date"),
  CONSTRAINT `fk_history_squeegees`
    FOREIGN KEY (`squeegee_id`)
    REFERENCES `toolingVal`.`squeegees` (`sq_id`));

CREATE TABLE `plate_history` (
  `plate_id` INT NOT NULL, 
  `pl_h_date` DATE NOT NULL,
  `pl_h_status` VARCHAR(10) NOT NULL,
  `pl_h_com` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`plate_id`,"pl_h_date"),
  CONSTRAINT `fk_history_plates`
    FOREIGN KEY (`plate_id`)
    REFERENCES `toolingVal`.`plates` (`pl_id`));